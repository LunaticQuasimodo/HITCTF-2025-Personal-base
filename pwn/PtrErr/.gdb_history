c
r
vmmap
aslr off
r
aslr on
r
vmmap
heap
ls
heap
x/100gx 0x567213a8
x/100wxx 0x567213a8
x/200wx 0x567213a8
vmmap
x/10gx 0x565f7e8c
x/100i 0x565f7e8c
x/10gx 0x565f7e8c
vmmap
x/10wx [200~0x565f7e8c~
x/10wx 0x565f7e8c
x/s 0x565f7e8c
heap
x/10wx0x567216b8
x/10wx 0x567216b8
search -parrern
search pattern
search pattern "/bin/sh"
search "/bin/sh"
x/100wx 0x56e773d0
heap
x/10wx0x56e773a8
x/10wx 0x56e773a8
x/10wx 0x56558130
p $BASE
P $BASE
p $base
vmmap
break *(0x17D0+0x56626000)
c
x/i 0x56627830
x/10i 0x56627830
vmmap
x/10gx 0x5662756d
heap
x/100wx 0x571273a8
x/100wx 0x571273a8 + 0x100
c
heap
x/100wx 0x580ad3a8
x/wx 0x56576130
x/wx 0x56576130
c
8 _IO_file_underflow+360                                                                                                                                                                                                                                                                                     
   3 0xf7b08386 _IO_default_uflow+54                                                                                                                                                                                                                                                                                       
   4 0xf7afa4e1 _IO_getline_info+161                                                                                                                                                                                                                                                                                       
   5 0xf7afa61e _IO_getline+30                                                                                                                                                                                                                                                                                             
   6 0xf7af9244 fgets+148                                                                                                                                                                                                                                                                                                  
   7 0x5656f5a6 None                                                                                                                                                                                                                                                                                                       
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                                                                                                                                                                                           
pwndbg> c                                                                                                                                                                                                                                                                                                                  
Continuing.                                                                                                                                                                                                                                                                                                                
Program received signal SIGSEGV, Segmentation fault.                                                                                                                                                                                                                                                                       
0x5656f7c5 in ?? ()                                                                                                                                                                                                                                                                                                        
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA                                                                                                                                                                                                                                                                           
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS / show-flags off / show-compact-regs off ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                                                                                                                                                                                           
*EAX  0                                                                                                                                                                                                                                                                                                                    
*EBX  0x56571f98 â—‚â€” 0x3e98                                                                                                                                                                                                                                                                                                 
*ECX  0x57360440 â—‚â€” 0x61616161 ('aaaa')                                                                                                                                                                                                                                                                                    
*EDX  0x573603b0 â€”â–¸ 0x5656f130 (system@plt) â—‚â€” jmp dword ptr [ebx + 0x48]                                                                                                                                                                                                                                                  
*EDI  0xf7f8cb60 (_rtld_global_ro) â—‚â€” 0                                                                                                                                                                                                                                                                                    
*ESI  0x573604b0 â—‚â€” 0                                                                                                                                                                                                                                                                                                      
*EBP  0xfff6f7d8 â—‚â€” 0                                                                                                                                                                                                                                                                                                      
*ESP  0xfff6e980 â—‚â€” 0                                                                                                                                                                                                                                                                                                      
*EIP  0x5656f7c5 â—‚â€” mov eax, dword ptr [eax]                                                                                                                                                                                                                                                                               
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM / i386 / set emulate on ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                                                                                                                                                                                           
 â–º 0x5656f7c5    mov    eax, dword ptr [eax]        <Cannot dereference [0]>                                                                                                                                                                                                                                               
   0x5656f7c7    sub    esp, 0xc                                                                                                                                                                                                                                                                                           
   0x5656f7ca    push   dword ptr [ebp - 0xe2c]                                                                                                                                                                                                                                                                            
   0x5656f7d0    call   eax                                                                                                                                                                                                                                                                                                
   0x5656f7d2    add    esp, 0x10                                                                                                                                                                                                                                                                                          
   0x5656f7d5    jmp    0x5656f56d                  <0x5656f56d>                                                                                                                                                                                                                                                           
    â†“                                                                                                                                                                                                                                                                                                                      
   0x5656f56d    mov    eax, dword ptr [ebx + 0x54]                                                                                                                                                                                                                                                                        
   0x5656f573    mov    eax, dword ptr [eax]                                                                                                                                                                                                                                                                               
   0x5656f575    push   eax                                                                                                                                                                                                                                                                                                
   0x5656f576    push   4
heap
c
vmmap
x/wx payload = p32(system_addr)+b'a'*(0x100-8)
x/wx 0x573603b0
x/wx 0x5656f130
x/10wx 0x5656f130
x/100wx 0x573603b0
x/100wx 0x573603b0-8
vmmap
break *(0x17BD+0x56563000 )
c
heap
x/10wx 0x578924b0
x/100wx 0x578924b0
x/10wx 0x6e69622f
heap
0x578924b0:     0x00000000      0x00000000      0x6e69622f      0x0068732f
0x578924c0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578924d0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578924e0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578924f0:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892500:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892510:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892520:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892530:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892540:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892550:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892560:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892570:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892580:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892590:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925a0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925b0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925c0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925d0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925e0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925f0:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892600:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892610:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892620:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892630:     0x41414141      0x41414141      0x41414141      0x41414141
pwndbg> x/10wx 0x6e69622f
0x6e69622f:     Cannot access memory at address 0x6e69622f
pwndbg> heap
Allocated chunk | PREV_INUSE
14141      0x41414141      0x41414141
0x578924f0:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892500:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892510:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892520:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892530:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892540:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892550:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892560:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892570:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892580:     0x41414141      0x41414141      0x41414141      0x41414141
0x57892590:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925a0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925b0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925c0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925d0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925e0:     0x41414141      0x41414141      0x41414141      0x41414141
0x578925f0:     0x41414141      0x41414141      0x41414141      0x41414141
x/100wx 0x578923b0
c
heap
x/wx 0x5663e7c5 
x/10wx 0x5663e7c5
heap
x/100wx 0x57abf3a8
break *(0x000017BD + )
vmmap
break *(0x000017BD +0x56581000)
c
x/100wx 0x56581000
x/100wx 0x582043b0
c
break system
c
x/s $rdi
x/s $edi
c
c
c
